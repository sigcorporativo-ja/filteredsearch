{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/templates/valuestable.html","webpack:///./src/templates/fieldstable.html","webpack:///./src/templates/filteredsearch.html","webpack:///./src/templates/seeresults.html","webpack:///./src/templates/initialview.html","webpack:///./src/templates/savedqueries.html","webpack:///./src/impl/ol/js/filteredsearchcontrol.js","webpack:///./src/facade/js/i18n/language.js","webpack:///./src/facade/js/filteredsearchcontrol.js","webpack:///./src/facade/js/filteredsearch.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","FilteredSearchControl","M","impl","Control","map","html","_get","_getPrototypeOf","this","translations","en","es","getLang","res","language","getTranslation","lang","getValue","keyPath","arguments","length","undefined","translation","utils","isNullOrEmpty","console","warn","concat","split","reduce","prev","current","values","_this","filteredsearchcontrol_classCallCheck","isUndefined","FilteredSearchImplControl","exception","filteredsearchcontrol_possibleConstructorReturn","filteredsearchcontrol_getPrototypeOf","pluginOnLeft","sqlQuery","mapeaFilterQuery","myqueries","parenthesesClick","operators","operatorCodes","fieldsPages","valuesPages","fields","fieldValues","currentFieldsPage","currentValuesPage","resultsPage","kmlLayers","_this2","Promise","success","fail","createInitialView","document","querySelector","addEventListener","evt","buttonOpened","classList","add","template","compileSync","vars","title","return_btn","accept_btn","clear_search","clear_filter","see_table","export","save","my_queries","remove_queries","appendChild","initialView","filterResults","seeResults","valuesTemplate","jsonp","addEvents","htmlSelect","subscribeActionLayer","setInitialButtons","getKML","layer","loaded","_this3","showLayerFields","target","selectedIndex","getAttribute","selectionMethod","querySelectorAll","forEach","element","e","operatorClick","btn","processQuery","replace","kmlLayer","on","LOAD","filter","_this4","options","layers","getLayers","Vector","select_layer","method","select_method","new_select","previous_selection","previous_remove","previous_add","filter_exp","placeholder","operator","btnTextNode","createTextNode","buttonNode","createElement","stringQ","pieces","nextOperator","findNextOperator","isThisTheLastOperator","substring","indexes","trim","translateOrderToQuery","saveOperands","turnStringIntoQuery","_this5","REMOVED_LAYER","Array","isArray","removeLayerOption","_objectSpread","ADDED_LAYER","addLayerOption","layerName","isNotAdded","htmlOption","setAttribute","innerText","select","_toConsumableArray","children","opt","removeChild","some","innerHTML","query","charAt","findClosingParentheses","operatorInWord","_this6","isLastOp","ops","cutQuery","v","operatorContainedInQuery","indexOf","possibleOperatorIndexes","operatorNotInWord","startEndIndexes","operands","startSplitIndex","endSplitIndex","push","operand","newOperand","_M$filter","_M$filter2","_M$filter3","_M$filter4","_M$filter5","_M$filter6","_M$filter7","mFilter","EQUAL","apply","attr","val","Function","feature","LT","GT","LTE","GTE","AND","OR","LIKE","NOT","openingIndex","closingParenthesesIndex","parenthesesCounter","operatorIndexes","inWord","previousChar","nextChar","match","index","position","isMFilterPar","includes","mapeaFilter","combinedFilter","oldFilter","dialog","error","optsContainer","btnContainer","layer_","oldLayer","setNewFilter","isValidQuery","setOkButtons","cleanSearch","removeFilter","saveResultsOnTable","setTableViewButtons","exportResults","myQueriesClick","showMyQueriesViewButtons","clickedQuery","getElementById","Select","style","display","container","compileMyQueriesTemplate","addSavedQueryClick","savedQueriesView","_this7","td","idx","savedQueryClicked","_this8","deleteAppliedFilters","setFilter","parentNode","row","rowCell","remove","deleteBtn","onclick","deleteSavedQuery","splice","child","lastElementChild","mySqlQueries","q","newQuery","savedQueries","queries","no_saved_queries","getWFS","type","getFilter","tryFilter","getMethodFilter","Error","err","features","getFeatures","csvString","dataToCsv","downloadCsv","csv","featureKeys","keys","getAttributes","featureAttrs","csvdata","fileUrl","encodeURI","hiddenLink","href","download","click","panelContainer","selected","pages","_this9","attributes","newLine","attributeKey","newTitleCell","cellText","filteredFeature","filteredAttributes","newCell","txt","toString","_this10","divideList","showTableViewPage","id","txtarea","toLowerCase","_this11","hasLayer_","isLayerLoaded","properties","fieldsTemplate","showFields","addpageBtnEvt","isLoaded","kmlLayerLoaded","find","getImpl","_this12","cell","fieldIndex","selectField","_this13","changePage","items","firstItem","newPage","fieldsOrValues","numberOfPages","currentPage","showPageResults","_this14","_this15","self","tableCell","selectValue","currentTarget","layerSearch","layersFind","isString","Layer","lay","equals","control","FilteredSearch","filteredsearch_classCallCheck","filteredsearch_possibleConstructorReturn","filteredsearch_getPrototypeOf","map_","controls_","position_","metadata_","api","metadata","Plugin","control_","panel_","ui","Panel","className","collapsible","collapsedButtonClass","tooltip","addControls","addPanels","removeControls","_ref","window","plugin","M$plugin$FilteredSearch","M$control$FilteredSearchControl","M$impl$control$FilteredSearchControl"],"mappings":"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","file":"filteredsearch.ol.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","module.exports = \"<div>\\n    <table id=\\\"m-filteredsearch-valuestable\\\">\\n        <tbody>\\n            {{#each values}}\\n                <tr>\\n                    <td>{{this}}</td>\\n                </tr>\\n            {{/each}}\\n        </tbody>\\n    </table>\\n    <div id=\\\"m-attributetable-tfoot\\\">\\n        <button id=\\\"prevBtn\\\">&#8810;</button>\\n        <span id=\\\"pageNumBtn\\\"></span>\\n        <button id=\\\"nextBtn\\\">&#8811;</button>\\n    </div>\\n</div>\";","module.exports = \"<div>\\n    <table id=\\\"m-filteredsearch-fieldstable\\\">\\n        <tbody>\\n            {{#each fields}}\\n                <tr>\\n                    <td>{{this}}</td>\\n                </tr>\\n            {{/each}}\\n        </tbody>\\n    </table>\\n    <div id=\\\"m-attributetable-tfoot\\\">\\n        <button id=\\\"prevBtn\\\">&#8810;</button>\\n        <span id=\\\"pageNumBtn\\\"></span>\\n        <button id=\\\"nextBtn\\\">&#8811;</button>\\n    </div>\\n</div>\";","module.exports = \"<div id=\\\"div-contenedor\\\" class=\\\"m-control m-container m-filteredsearch\\\">\\n\\n    <div class=\\\"title\\\">{{translations.title}}</div>\\n\\n    <div id=\\\"m-filteredsearch-options-container\\\"></div>\\n\\n    <div id=\\\"m-filteredsearch-options-buttons\\\">\\n        <button id=\\\"volver-btn\\\">{{translations.return_btn}}</button>\\n        <button id=\\\"aceptar-btn\\\">{{translations.accept_btn}}</button>\\n        <button id=\\\"limpiar-busqueda-btn\\\">{{translations.clear_search}}</button>\\n        <button id=\\\"limpiar-filtro-btn\\\">{{translations.clear_filter}}</button>\\n        <button id=\\\"vertabla-btn\\\">{{translations.see_table}}</button>\\n        <button id=\\\"exportar-btn\\\">{{translations.export}}</button>\\n        <button id=\\\"guardar-btn\\\">{{translations.save}}</button>\\n        <button id=\\\"misconsultas-btn\\\">{{translations.my_queries}}</button>\\n        <button id=\\\"eliminar-btn\\\">{{translations.remove_queries}}</button>\\n    </div>\\n\\n</div>\";","module.exports = \"<div>\\n    <table id='queryresults'></table>\\n    <div id=\\\"paginationbuttons\\\">\\n        <button id=\\\"prevBtn\\\">&#8810;</button>\\n        <span id=\\\"pageNumBtn\\\"></span>\\n        <button id=\\\"nextBtn\\\">&#8811;</button>\\n    </div>\\n</div>\";","module.exports = \"<div id=\\\"m-filteredsearch-initialview\\\">\\n    <div id=\\\"m-filteredsearch-selects-container\\\">\\n        <p class=\\\"m-filteredsearch-headers\\\">{{translations.layer}}</p>\\n        <select id=\\\"m-filteredsearch-layers-select\\\">\\n            <option disabled=\\\"disabled\\\" id=\\\"layers0\\\" selected=\\\"selected\\\">{{translations.select_layer}}</option>\\n            {{#each layers}}\\n                <option name=\\\"{{this.name}}\\\">{{this.name}}</option>\\n            {{/each}}\\n        </select>\\n        <p class=\\\"m-filteredsearch-headers\\\">{{translations.method}}</p>\\n        <select id=\\\"m-filteredsearch-method-select\\\">\\n            <option disabled=\\\"disabled\\\" selected=\\\"selected\\\" value=\\\"0\\\">{{translations.select_method}}</option>\\n            <option value=\\\"1\\\">{{translations.new_select}}</option>\\n            <option value=\\\"2\\\">{{translations.previous_selection}}</option>\\n            <option value=\\\"3\\\">{{translations.previous_remove}}</option>\\n            <option value=\\\"4\\\">{{translations.previous_add}}</option>\\n        </select>\\n    </div>\\n\\n    <div id=\\\"m-filteredsearch-lists-container\\\">\\n        <div id=\\\"m-filteredsearch-fields\\\">\\n            <p class=\\\"m-filteredsearch-headers\\\">{{translations.fields}}</p>\\n            <!-- Insert here fieldstable.html template. -->\\n        </div>\\n        <div id=\\\"m-filteredsearch-values\\\">\\n            <p class=\\\"m-filteredsearch-headers\\\">{{translations.values}}</p>\\n            <!-- Insert here valuestable.html template. -->\\n        </div>\\n    </div>\\n\\n    <div id=\\\"m-filteredsearch-operators-container\\\">\\n        <p class=\\\"m-filteredsearch-headers\\\">{{translations.operators}}</p>\\n        <!-- Insert here operator buttons. -->\\n    </div>\\n\\n    <div id=\\\"m-filteredsearch-query-container\\\">\\n        <p class=\\\"m-filteredsearch-headers\\\">{{translations.filter_exp}}</p>\\n        <textarea id=\\\"m-filteredsearch-textArea\\\" cols=\\\"90\\\" rows=\\\"5\\\" placeholder=\\\"{{translations.placeholder}}\\\"></textarea>\\n    </div>\\n</div>\";","module.exports = \"<div>\\n    {{#if queries}}\\n        <table>\\n            {{#each queries}}\\n                <tr>\\n                    <td>{{this.query}}</td>\\n                </tr>\\n            {{/each}}\\n        </table>\\n    {{else}}\\n        <p>No hay consultas guardadas.</p>\\n    {{/if}}\\n</div>\";","/**\n * @module M/impl/control/FilteredSearchControl\n */\nexport default class FilteredSearchControl extends M.impl.Control {\n  /**\n   * This function adds the control to the specified map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the plugin\n   * @param {HTMLElement} html of the plugin\n   * @api stable\n   */\n  addTo(map, html) {\n    // obtengo la interacción por defecto del dblclick para manejarla\n    super.addTo(map, html);\n  }\n}\n","import en from './en';\nimport es from './es';\n\n/**\n * Default object with es and en translate.\n *\n * @const\n * @type {object}\n */\nconst translations = {\n  en,\n  es,\n};\n\nconst getLang = () => {\n  let res = 'es';\n  if (typeof M.language.getLang === 'function') {\n    res = M.language.getLang();\n  }\n\n  return res;\n};\n\n/**\n * This function sets a new language translate.\n * @param {string} lang\n * @param {JSON} json\n * @public\n * @api\n */\nexport const addTranslation = (lang, json) => {\n  translations[lang] = json;\n};\n\n/**\n * This function gets a language translate.\n *\n * @param {string} lang\n * @return {JSON}\n * @public\n * @api\n */\nexport const getTranslation = (lang) => {\n  return translations[lang];\n};\n\n/**\n * This function gets a language value from key\n *\n * @public\n * @param {string}\n * @param {string}\n * @return {string}\n * @public\n * @api\n */\n\nexport const getValue = (keyPath, lang = getLang()) => {\n  const translation = getTranslation(lang);\n  let value = '';\n  if (M.utils.isNullOrEmpty(translation)) {\n    /* eslint-disable no-console */\n    console.warn(`The translation '${lang}' has not been defined.`);\n  } else {\n    value = keyPath.split('.').reduce((prev, current) => prev[current], translation);\n  }\n\n  return value;\n};\n","/**\n * @module M/control/FilteredSearchControl\n */\n\nimport FilteredSearchImplControl from 'impl/filteredsearchcontrol';\nimport template from 'templates/filteredsearch';\nimport fieldsTemplate from 'templates/fieldstable';\nimport valuesTemplate from 'templates/valuestable';\nimport seeResults from 'templates/seeresults';\nimport initialView from 'templates/initialview';\nimport savedQueries from 'templates/savedqueries';\nimport { getValue } from './i18n/language';\n\nexport default class FilteredSearchControl extends M.Control {\n  /**\n   * @classdesc\n   * Main constructor of the class. Creates a PluginControl\n   * control\n   *\n   * @constructor\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(values) {\n    if (M.utils.isUndefined(FilteredSearchImplControl)) {\n      M.exception('La implementación usada no puede crear controles FilteredSearchControl');\n    }\n    const impl = new FilteredSearchImplControl();\n    super(impl, 'FilteredSearch');\n    this.pluginOnLeft = values.pluginOnLeft;\n    /**\n     * Filtering query (written in sql style)\n     * @public\n     */\n    this.sqlQuery = '';\n\n    /**\n     * Mapea filter with the user's query.\n     * @public\n     */\n    this.mapeaFilterQuery = null;\n\n    /**\n     * Saved queries\n     * @public\n     */\n    this.myqueries = [];\n\n    /**\n     * Parentheses click counter\n     * @public\n     * If 0, a '(' is written. If 1, a ')'.\n     */\n    this.parenthesesClick = 0;\n\n    /**\n     * Operators for creating queries\n     * @public\n     */\n    this.operators = ['=', '<', '>', '<=', '>=', '<>', '()', 'and', 'or', 'not', 'like', '%', '_'];\n\n    /**\n     * Operators html codes.\n     * @public\n     */\n    this.operatorCodes = ['&#61;', '&lt;', '&gt;'];\n\n    /**\n     * Layer fields items divided by page.\n     * format: [[item_1, item_2, item_3], [i4, i5, i6], ... ]\n     * @public\n     */\n    this.fieldsPages = [];\n\n    /**\n     * Layer field values items divided by page.\n     * format: [[item_1, item_2, item_3], [i4, i5, i6], ... ]\n     * @public\n     */\n    this.valuesPages = [];\n\n    /**\n     * Selected layer attributes list.\n     * @public\n     */\n    this.fields = [];\n\n    /**\n     * Possible values for all fields of the selected layer.\n     * @public\n     */\n    this.fieldValues = [];\n\n    /**\n     * Fields page counter\n     * @public\n     */\n    this.currentFieldsPage = 0;\n\n    /**\n     * Field values page counter.\n     * @public\n     */\n    this.currentValuesPage = 0;\n\n    /**\n     * Table view results page counter.\n     * @public\n     */\n    this.resultsPage = 0;\n\n    /**\n     * KML layers added to map.\n     * @public\n     */\n    this.kmlLayers = [];\n  }\n\n  /**\n   * This function creates the view\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  createView(map) {\n    this.map = map;\n    return new Promise((success, fail) => {\n      this.createInitialView(map);\n\n      // Desplazar open button\n      if (this.pluginOnLeft) {\n        document.querySelector('.m-panel.filtered-search-panel').querySelector('.m-panel-btn.g-plugin-filteredsearch-filter').addEventListener('click', (evt) => {\n          let buttonOpened = document.querySelector('.m-panel.filtered-search-panel.opened');\n          if (buttonOpened !== null) {\n            buttonOpened = buttonOpened.querySelector('.m-panel-btn.g-cartografia-flecha-izquierda');\n          }\n          if (buttonOpened && this.pluginOnLeft) {\n            buttonOpened.classList.add('opened-left');\n          }\n        });\n      }\n\n      const html = M.template.compileSync(template, {\n        vars: {\n          translations: {\n            title: getValue('title'),\n            return_btn: getValue('return'),\n            accept_btn: getValue('accept'),\n            clear_search: getValue('clear_search'),\n            clear_filter: getValue('clear_filter'),\n            see_table: getValue('see_table'),\n            export: getValue('export'),\n            save: getValue('save'),\n            my_queries: getValue('my_queries'),\n            remove_queries: getValue('remove_queries'),\n          },\n        },\n      });\n      html.querySelector('#m-filteredsearch-options-container').appendChild(this.initialView);\n      this.filterResults = M.template.compileSync(seeResults);\n      this.valuesTemplate = M.template\n        .compileSync(valuesTemplate, { jsonp: true, vars: { values: [] } });\n      this.addEvents(html);\n      const htmlSelect = html.querySelector('#m-filteredsearch-layers-select');\n      this.subscribeActionLayer(htmlSelect);\n      this.setInitialButtons(html);\n      this.kmlLayers = this.map.getKML().map((layer) => {\n        return { layer, loaded: false };\n      });\n      success(html);\n    });\n  }\n\n  /**\n   * Adds event listeners to several HTML elements.\n   * @public\n   * @function\n   * @param {HTML Element} html - 'filteredsearch.html' template\n   * @api\n   */\n  addEvents(html) {\n    this.initialView.querySelector('#m-filteredsearch-layers-select').addEventListener('change', (evt) => {\n      this.showLayerFields(evt.target[evt.target.selectedIndex].getAttribute('name'));\n    });\n    this.initialView.querySelector('#m-filteredsearch-method-select').addEventListener('change', (evt) => {\n      this.selectionMethod = evt.target.value;\n    });\n    html.querySelectorAll('#m-filteredsearch-operators-container>button').forEach((element) => {\n      element.addEventListener('click', e => this.operatorClick(e, element));\n    });\n    html.querySelectorAll('#m-filteredsearch-options-buttons>button')\n      .forEach(btn => btn.addEventListener('click', (e) => {\n        this.processQuery(e);\n      }));\n    html.querySelector('#m-filteredsearch-query-container>textarea').addEventListener('input', (e) => {\n      this.sqlQuery = e.target.value.replace(/_/g, '.').replace(/%/g, '.*');\n      this.setInitialButtons(document.querySelector('#m-filteredsearch-options-buttons'));\n    });\n    // checks if KML layers are loaded and saves flag on this.kmlLayers object\n    this.map.getKML().forEach((kmlLayer) => {\n      kmlLayer.on(M.evt.LOAD, () => {\n        this.kmlLayers.filter((layer) => {\n          return layer.layer === kmlLayer;\n        })[0].loaded = true;\n      });\n    });\n  }\n\n  /**\n   * Creates initialview.html template dinamically.\n   * @public\n   * @function\n   * @api\n   * @param {Map} map\n   */\n  createInitialView(map) {\n    const options = {\n      jsonp: true,\n      vars: {\n        layers: map.getLayers()\n          .filter(layer => layer instanceof M.layer.Vector && layer.name !== '__draw__'),\n        translations: {\n          layer: getValue('layer'),\n          select_layer: getValue('select_layer'),\n          method: getValue('method'),\n          select_method: getValue('select_method'),\n          new_select: getValue('new_select'),\n          previous_selection: getValue('previous_selection'),\n          previous_remove: getValue('previous_remove'),\n          previous_add: getValue('previous_add'),\n          fields: getValue('fields'),\n          values: getValue('values'),\n          operators: getValue('operators'),\n          filter_exp: getValue('filter_exp'),\n          placeholder: getValue('placeholder'),\n        },\n      },\n    };\n    this.initialView = M.template.compileSync(initialView, options);\n    this.operators.forEach((operator) => {\n      const btnTextNode = document.createTextNode(operator);\n      const buttonNode = document.createElement('button');\n      buttonNode.appendChild(btnTextNode);\n      this.initialView.querySelector('#m-filteredsearch-operators-container').appendChild(buttonNode);\n    });\n  }\n\n  /**\n   * Turns sql-like query string into Mapea filter.\n   * @public\n   * @function\n   * @api\n   * @param { String } stringQ - sql-like query\n   */\n  turnStringIntoQuery(stringQ) {\n    let pieces = [];\n    let mapeaFilter;\n    const nextOperator = this.findNextOperator(stringQ);\n    if (!this.isThisTheLastOperator(stringQ, nextOperator)) {\n      pieces = this.saveOperands(stringQ, nextOperator.indexes);\n      for (let i = 0; i < pieces.length; i += 1) {\n        pieces[i] = this.turnStringIntoQuery(pieces[i]);\n      }\n    } else {\n      pieces[0] = stringQ.substring(0, nextOperator.indexes[0]).trim();\n      pieces[1] = stringQ.substring(nextOperator.indexes[1] + 1).trim();\n      mapeaFilter = this.translateOrderToQuery(nextOperator.operator, pieces);\n      return mapeaFilter;\n    }\n\n    mapeaFilter = this.translateOrderToQuery(nextOperator.operator, pieces);\n\n    return mapeaFilter;\n  }\n\n  /**\n   * Action layer in Selects layers\n   * @public\n   * @function\n   * @param {HTMLElement} html to add the plugin\n   * @api stable\n   */\n  subscribeActionLayer(html) {\n    // Subscribe remove layer event.\n    this.map.on(M.evt.REMOVED_LAYER, (layers) => {\n      if (Array.isArray(layers)) {\n        layers.filter(layer => layer instanceof M.layer.Vector)\n          .forEach(layer => this.removeLayerOption(html, layer));\n      } else if (layers instanceof M.layer.Vector) {\n        const layer = { ...layers };\n        this.removeLayerOption(html, layer);\n      }\n    });\n    // Subscribe add layer event.\n    this.map.on(M.evt.ADDED_LAYER, (layers) => {\n      if (Array.isArray(layers)) {\n        layers.filter(layer => layer instanceof M.layer.Vector)\n          .forEach(layer => this.addLayerOption(html, layer));\n      } else if (layers instanceof M.layer.Vector) {\n        const layer = { ...layers };\n        this.addLayerOption(html, layer);\n      }\n    });\n  }\n\n  /**\n   * Add html option in Selects.\n   * @public\n   * @function\n   * @param { HTMLElement } html to add the plugin\n   * @api stable\n   */\n  addLayerOption(htmlSelect, layer) {\n    const layerName = layer.name;\n    if (layerName !== 'cluster_cover' && this.isNotAdded(layerName, htmlSelect)) {\n      const htmlOption = document.createElement('option');\n      htmlOption.setAttribute('name', layerName);\n      htmlOption.innerText = layerName;\n      htmlSelect.add(htmlOption);\n    }\n  }\n\n  /**\n   * Remove html option in Selects.\n   * @public\n   * @function\n   * @param { HTMLElement } html to add the plugin\n   * @api stable\n   */\n  removeLayerOption(select, layer) {\n    const layerName = layer.name;\n    const htmlSelect = select;\n    if (layerName !== 'cluster_cover' && !this.isNotAdded(layerName, htmlSelect)) {\n      const arrayOptions = [...htmlSelect.children];\n      arrayOptions.forEach((opt) => {\n        if (opt.innerText === layerName) {\n          htmlSelect.removeChild(opt);\n          // htmlSelect.selectedIndex = 0;\n        }\n      });\n      htmlSelect.selectedIndex = 0;\n    }\n  }\n\n  /**\n   * Check if the layer is not added yet.\n   * @public\n   * @function\n   * @param { String } name of layer to add.\n   * @api stable\n   */\n  isNotAdded(layerName, htmlSelect) {\n    const aChildren = [...htmlSelect.children];\n    return !aChildren.some(o => o.innerHTML === layerName);\n  }\n\n  /**\n   * Finds the next most important operator on a string.\n   * @public\n   * @function\n   * @api\n   * @param {String} query - query string\n   */\n  findNextOperator(query) { // TODO: shorten this method\n    let operator = '';\n    const indexes = [];\n\n    // First, and/or search (outside parentheses)\n    for (let i = 0; i < query.length; i += 1) {\n      // avoids searching inside ()\n      if (query.charAt(i) === '(') {\n        const closingParenthesesIndex = this.findClosingParentheses(query, i);\n        i = closingParenthesesIndex + 1;\n      }\n\n      if ((query.substring(i, i + 3) === 'and' &&\n        !this.operatorInWord(query, [i, i + 2])) ||\n        (query.substring(i, i + 2) === 'or' &&\n          !this.operatorInWord(query, [i, i + 1]))\n      ) {\n        if (query.substring(i, i + 3) === 'and') {\n          operator = query.substring(i, i + 3);\n          indexes[0] = i;\n          indexes[1] = i + 2;\n        } else { // or\n          operator = query.substring(i, i + 2);\n          indexes[0] = i;\n          indexes[1] = i + 1;\n        }\n        i = query.length;\n      }\n    }\n\n    if (operator === '') {\n      for (let i = 0; i < query.length; i += 1) {\n        // avoids searching inside ()\n        if (query.charAt(i) === '(') {\n          const closingParenthesesIndex = this.findClosingParentheses(query, i);\n          i = closingParenthesesIndex + 1;\n        }\n\n        if ((query.substring(i, i + 3) === 'not' &&\n          !this.operatorInWord(query, [i, i + 2])) ||\n          (query.substring(i, i + 4) === 'like' &&\n            !this.operatorInWord(query, [i, i + 3]))) {\n          if (query.substring(i, i + 3) === 'not') {\n            operator = query.substring(i, i + 3);\n            indexes[0] = i;\n            indexes[1] = i + 2;\n          } else { // like\n            operator = query.substring(i, i + 4);\n            indexes[0] = i;\n            indexes[1] = i + 3;\n          }\n          i = query.length;\n        }\n      }\n    }\n\n    if (operator === '') {\n      for (let i = 0; i < query.length; i += 1) {\n        // avoids searching inside ()\n        if (query.charAt(i) === '(') {\n          const closingParenthesesIndex = this.findClosingParentheses(query, i);\n          i = closingParenthesesIndex + 1;\n        }\n\n        if (query.substring(i, i + 2) === '<=' ||\n          query.substring(i, i + 2) === '>=' ||\n          query.substring(i, i + 2) === '<>') {\n          operator = query.substring(i, i + 2);\n          indexes[0] = i;\n          indexes[1] = i + 1;\n          i = query.length;\n        } else if (query.charAt(i) === '=' || query.charAt(i) === '<' ||\n          query.charAt(i) === '>') {\n          operator = query.charAt(i);\n          indexes[0] = i;\n          indexes[1] = i;\n          i = query.length;\n        }\n      }\n    }\n\n    return { operator, indexes };\n  }\n\n  /**\n   * Checks if a string has any operators other than the given one.\n   * @function\n   * @public\n   * @param {String} query\n   * @param {String} operator\n   * @api\n   */\n  isThisTheLastOperator(query, operator) {\n    let isLastOp = true;\n    const ops = ['=', '<=', '>=', '<>', '(', 'and', 'or', 'not', 'like'];\n    const cutQuery = `${query.substring(0, operator.indexes[0])}${query.substring(operator.indexes[1] + 1)}`;\n    if (\n      ops.some((v) => {\n        const operatorContainedInQuery = cutQuery.indexOf(v) >= 0;\n        const possibleOperatorIndexes = [\n          cutQuery.indexOf(v),\n          (cutQuery.indexOf(v) + ops[ops.indexOf(v)].length) - 1,\n        ];\n        const operatorNotInWord = !this.operatorInWord(cutQuery, possibleOperatorIndexes);\n        return operatorContainedInQuery && operatorNotInWord;\n      })) {\n      isLastOp = false;\n    }\n    return isLastOp;\n  }\n\n  /**\n   * Splits string into operands by operator position.\n   * @public\n   * @function\n   * @api\n   * @param {String} query - query string\n   * @param {String} operator - calculation operator\n   * @param {Array} startEndIndexes - operands limits\n   */\n  saveOperands(query, startEndIndexes) {\n    let operands = [];\n    const startSplitIndex = startEndIndexes[0];\n    const endSplitIndex = startEndIndexes[1];\n\n    if (startSplitIndex !== 0) {\n      operands.push(query.substring(0, startSplitIndex).trim());\n    }\n    operands.push(query.substring(endSplitIndex + 1).trim());\n\n    operands = operands.map((operand) => {\n      let newOperand = operand;\n      if (operand[0] === '(') {\n        newOperand = newOperand.substring(1);\n      }\n      if (operand[operand.length - 1] === ')') {\n        newOperand = newOperand.substring(0, operand.length - 1);\n      }\n      return newOperand;\n    });\n\n    return operands;\n  }\n\n  /**\n   * Turns simple query expression into Mapea filter.\n   * @public\n   * @function\n   * @param {String} operator - operator to apply on split query\n   * @param { Array < String > } pieces - expression operands\n   * @api\n   */\n  translateOrderToQuery(operator, pieces) {\n    let mFilter = '';\n\n    switch (operator) {\n      case '=':\n        mFilter = M.filter.EQUAL(...pieces);\n        break;\n      case '<>':\n        const attr = pieces[0];\n        const val = pieces[1];\n        mFilter = new M.filter.Function((feature) => {\n          return feature.getAttribute(attr) !== val;\n        });\n        break;\n      case '<':\n        mFilter = M.filter.LT(...pieces);\n        break;\n      case '>':\n        mFilter = M.filter.GT(...pieces);\n        break;\n      case '<=':\n        mFilter = M.filter.LTE(...pieces);\n        break;\n      case '>=':\n        mFilter = M.filter.GTE(...pieces);\n        break;\n      case 'and':\n        mFilter = M.filter.AND([...pieces]);\n        break;\n      case 'or':\n        mFilter = M.filter.OR([...pieces]);\n        break;\n      case 'like':\n        mFilter = M.filter.LIKE(...pieces);\n        break;\n      case 'not':\n        mFilter = M.filter.NOT(...pieces);\n        break;\n      default:\n    }\n\n    return mFilter;\n  }\n\n  /**\n   * Finds the closing parentheses of a pair.\n   * @public\n   * @function\n   * @api\n   * @param {String} query - query string where the parentheses set is found\n   * @param { Number } openingIndex - opening parentheses index\n   */\n  findClosingParentheses(query, openingIndex) {\n    let closingParenthesesIndex;\n    let parenthesesCounter = 0;\n    for (let i = openingIndex + 1; i < query.length; i += 1) {\n      if (parenthesesCounter === 0 && query.charAt(i) === ')') {\n        closingParenthesesIndex = i;\n        i = query.length;\n      } else if (query.charAt(i) === '(') {\n        parenthesesCounter += 1;\n      } else if (query.charAt(i) === ')' && parenthesesCounter !== 0) {\n        parenthesesCounter -= 1;\n      }\n    }\n    return closingParenthesesIndex;\n  }\n\n  /**\n   * Checks if given operator is part of a word or a real operator.\n   * Returns true if it's a real operator.\n   * @public\n   * @function\n   * @api\n   * @param {String} query - string in which the operator candidate is found\n   * @param { Array < String > } operatorIndexes - start and end operator indexes on query\n   */\n  operatorInWord(query, operatorIndexes) {\n    let inWord = false;\n    const startSplitIndex = operatorIndexes[0];\n    const endSplitIndex = operatorIndexes[1];\n    const previousChar = query[startSplitIndex - 1];\n    const nextChar = query[endSplitIndex + 1];\n\n    if (((previousChar !== undefined) && (previousChar.match(/[a-z]/i))) ||\n      ((nextChar !== undefined) && (nextChar.match(/[a-z]/i)))) {\n      inWord = true;\n    }\n\n    return inWord;\n  }\n\n  /**\n   * Checks if a parentheses in a string belongs to a Mapea filter method.\n   * @public\n   * @function\n   * @param { String } query - complete or partial query string\n   * @param {Number} index - indexOf first parentheses on string\n   * @api\n   */\n  isMapeaFilterParentheses(query, index) {\n    const twoLettersOperators = ['OR', 'LT', 'GT'];\n    const threeLettersOperators = ['AND', 'NOT', 'LTE', 'GTE'];\n    const position = index;\n    let isMFilterPar = false;\n\n    if ((((position - 11 !== -1) && (query.substring(position - 11, position - 2) === 'M.filter.')) &&\n      twoLettersOperators.includes(query.substring(position - 2, position))) ||\n      (((position - 12 !== -1) && (query.substring(position - 12, position - 3) === 'M.filter.')) &&\n        threeLettersOperators.includes(query.substring(position - 3, position))) ||\n      (((position - 13 !== -1) && (query.substring(position - 13, position - 4) === 'M.filter.')) &&\n        (query.substring(position - 4, position) === 'LIKE')) ||\n      (((position - 14 !== -1) && (query.substring(position - 14, position - 5) === 'M.filter.')) &&\n        (query.substring(position - 5, position) === 'EQUAL'))) {\n      isMFilterPar = true;\n    }\n\n    return isMFilterPar;\n  }\n\n  /**\n   * Turns new given filter into a filter that combines the already applied filter and the new one.\n   * @public\n   * @function\n   * @param { M.Filter } mapeaFilter - new query filter\n   * @api\n   */\n  getMethodFilter(mapeaFilter) {\n    let combinedFilter;\n    switch (this.selectionMethod) {\n      case '1':\n        combinedFilter = mapeaFilter;\n        break;\n      case '2':\n        if (this.oldFilter !== undefined) {\n          // AND nueva query\n          combinedFilter = M.filter.AND([this.oldFilter, mapeaFilter]);\n        } else {\n          M.dialog.error(getValue('no_previous_query'));\n        }\n        break;\n      case '3':\n        if (this.oldFilter !== undefined) {\n          // AND NOT nueva query\n          combinedFilter = M.filter.AND([this.oldFilter, M.filter.NOT(mapeaFilter)]);\n        } else {\n          M.dialog.error(getValue('no_previous_query'));\n        }\n        break;\n      case '4':\n        if (this.oldFilter !== undefined) {\n          // OR nueva query\n          combinedFilter = M.filter.OR([this.oldFilter, mapeaFilter]);\n        } else {\n          M.dialog.error(getValue('no_previous_query'));\n        }\n        break;\n      default:\n        M.dialog.error(getValue('must_select_method'));\n        break;\n    }\n\n    return combinedFilter;\n  }\n\n  /**\n   * Performs button action onClick.\n   * @public\n   * @function\n   * @param {Event} e - triggering event\n   * @api\n   */\n  processQuery(e) {\n    const optsContainer = document.querySelector('#m-filteredsearch-options-container');\n    const btnContainer = document.querySelector('#m-filteredsearch-options-buttons');\n    const action = e.target.getAttribute('id');\n\n    switch (action) {\n      case 'aceptar-btn':\n        if (this.layer_ === undefined) {\n          M.dialog.error(getValue('must_select_layer'));\n        } else {\n          if (this.selectionMethod === '1') {\n            this.oldFilter = undefined;\n            this.oldLayer = undefined;\n          }\n          this.setNewFilter();\n          if (this.isValidQuery && this.selectionMethod !== undefined) this.setOkButtons();\n        }\n        break;\n      case 'limpiar-busqueda-btn':\n        this.cleanSearch();\n        break;\n      case 'limpiar-filtro-btn':\n        this.layer_.removeFilter();\n        this.setInitialButtons(btnContainer);\n        break;\n      case 'vertabla-btn':\n        this.saveResultsOnTable();\n        optsContainer.innerHTML = '';\n        optsContainer.appendChild(this.filterResults);\n        this.setTableViewButtons(btnContainer);\n        break;\n      case 'exportar-btn':\n        this.exportResults();\n        break;\n      case 'guardar-btn':\n        if (this.isValidQuery) {\n          this.myqueries.push({\n            query: this.sqlQuery,\n            layer: this.layer_,\n          });\n        } else {\n          M.dialog.error(getValue('invalid_query'));\n        }\n        break;\n      case 'misconsultas-btn':\n        this.myQueriesClick(optsContainer);\n        this.showMyQueriesViewButtons(btnContainer);\n        break;\n      case 'volver-btn':\n        optsContainer.innerHTML = '';\n        optsContainer.appendChild(this.initialView);\n        this.setOkButtons();\n        if (this.clickedQuery !== undefined) {\n          document.getElementById('m-filteredsearch-textArea').value = this.clickedQuery.query;\n          const Select = document.getElementById('m-filteredsearch-layers-select');\n          // eslint-disable-next-line no-plusplus\n          for (let i = 0; i < Select.options.length; i++) {\n            if (Select.options[i].value === this.clickedQuery.layer.name) {\n              Select.options.selectedIndex = [i];\n            }\n          }\n          this.clickedQuery = undefined;\n        }\n        // TODO: check if there's a filter applied to show data btns or not\n        document.querySelector('#guardar-btn').style.display = 'none';\n        break;\n      case 'eliminar-btn':\n        // this.deleteFromButton();\n        break;\n      default:\n        break;\n    }\n  }\n\n  /**\n   * Shows saved queries view (saved queries with filter activation on click).\n   * @public\n   * @function\n   * @api\n   * @param {HTML Element} central panel\n   */\n  myQueriesClick(container) {\n    const optsContainer = container;\n    optsContainer.innerHTML = '';\n\n    this.compileMyQueriesTemplate();\n\n    this.addSavedQueryClick();\n\n    optsContainer.appendChild(this.savedQueriesView);\n  }\n\n  /**\n   * Adds event listener for click on saved query table cell.\n   * @public\n   * @function\n   * @api\n   */\n  addSavedQueryClick() {\n    this.savedQueriesView.querySelectorAll('td').forEach((td, idx) => {\n      td.addEventListener('click', (e) => {\n        this.savedQueryClicked(e, td, idx);\n      });\n    });\n  }\n\n  /**\n   * Deletes previous filters and applies clicked filter to map.\n   * Adds focus to clicked query cell.\n   * Shows delete query button.\n   * @param {Event} e - triggering event\n   * @param {HTML Element} td - clicked query table cell\n   * @param {Number} idx - this.myqueries clicked query index\n   */\n  savedQueryClicked(e, td, idx) {\n    this.deleteAppliedFilters();\n    this.clickedQuery = this.myqueries[idx];\n    this.mapeaFilterQuery = this.turnStringIntoQuery(this.clickedQuery.query);\n    this.layer_ = this.clickedQuery.layer;\n    this.layer_.setFilter(this.mapeaFilterQuery);\n\n    Array.prototype.forEach.call(\n      e.target.parentNode.parentNode.parentNode.children[0].children,\n      (row) => {\n        Array.prototype.forEach.call(row.children, (rowCell) => {\n          rowCell.classList.remove('focus');\n        });\n      },\n    );\n    e.target.classList.add('focus');\n\n    const deleteBtn = document.querySelector('#m-filteredsearch-options-buttons').querySelector('#eliminar-btn');\n    deleteBtn.style.display = 'inline';\n    deleteBtn.onclick = () => {\n      this.deleteSavedQuery(td, idx);\n      this.compileMyQueriesTemplate();\n      this.addSavedQueryClick();\n      document.querySelector('#m-filteredsearch-options-container').appendChild(this.savedQueriesView);\n    };\n  }\n\n  /**\n   * Deletes saved query from this.myqueries.\n   * @public\n   * @function\n   * @param {HTML Element} td - results table cell with query\n   * @param {Number} idx - saved queries array query index\n   * @api\n   */\n  deleteSavedQuery(td, idx) {\n    this.myqueries.splice(idx, 1);\n    td.parentNode.remove();\n    document.querySelector('#m-filteredsearch-options-buttons').querySelector('#eliminar-btn').style.display = 'none';\n    this.sqlQuery = '';\n    this.layer_.removeFilter();\n    if (this.myqueries.length === 0) {\n      document.querySelector('#m-filteredsearch-options-container').innerHTML = getValue('no_saved_queries');\n    }\n  }\n\n  /**\n   * Compiles savedQueries template with this.myqueries data.\n   * @public\n   * @function\n   * @api\n   */\n  compileMyQueriesTemplate() {\n    if (this.savedQueriesView !== undefined) {\n      let child = this.savedQueriesView.lastElementChild;\n      while (child) {\n        child.remove();\n        child = this.savedQueriesView.lastElementChild;\n      }\n    }\n\n    this.mySqlQueries = this.myqueries.map((q) => {\n      const newQuery = q;\n      newQuery.query = q.query.replace(/\\.\\*/g, '%').replace(/\\./g, '_');\n      return newQuery;\n    });\n    this.savedQueriesView = M.template.compileSync(savedQueries, {\n      vars: {\n        queries: this.mySqlQueries,\n        translations: {\n          no_saved_queries: getValue('no_saved_queries'),\n        },\n      },\n    });\n  }\n\n  /**\n   * Resets every layer to initial filter (null).\n   * @public\n   * @function\n   * @api\n   */\n  deleteAppliedFilters() {\n    const vectorLayers = this.map.getWFS()\n      .concat(this.map.getKML()\n        .concat(this.map.getLayers().filter((layer) => {\n          return layer.type === 'GeoJSON';\n        })));\n    vectorLayers.forEach((layer) => {\n      if (layer.getFilter !== null) layer.removeFilter();\n    });\n  }\n\n  /**\n   * Sets new filter on layer.\n   * @public\n   * @function\n   * @api\n   */\n  setNewFilter() {\n    // Sets new filter\n    if (this.sqlQuery === '') {\n      M.dialog.error(getValue('must_query'));\n      // Resets last saved query\n      this.mapeaFilterQuery = this.oldFilter;\n      this.layer_ = this.oldLayer;\n    } else if (this.oldLayer !== undefined && this.oldLayer !== this.layer_) {\n      M.dialog.error(getValue('cant_apply'));\n      // Resets last saved query\n      this.mapeaFilterQuery = this.oldFilter;\n      this.layer_ = this.oldLayer;\n    } else {\n      // Gets new query\n      let tryFilter;\n\n      // FIXME: Trying to do nothing if filter doesn't get set on map\n      // Cases visibility and description of 'Arboleda' layer never enter catch. Doesn't work right.\n      try {\n        tryFilter = this.turnStringIntoQuery(this.sqlQuery);\n        tryFilter = this.getMethodFilter(tryFilter);\n        this.layer_.setFilter(tryFilter);\n        if (this.layer_.getFilter() !== null) {\n          this.mapeaFilterQuery = tryFilter;\n          this.oldFilter = this.mapeaFilterQuery;\n          this.oldLayer = this.layer_;\n          this.isValidQuery = true;\n        } else {\n          this.isValidQuery = false;\n          throw new Error(getValue('invalid_filter'));\n        }\n      } catch (err) {\n        this.isValidQuery = false;\n        M.dialog.error(getValue('cant_apply_filter'));\n      }\n    }\n  }\n\n  /**\n   * Downloads .csv file with results data.\n   * @public\n   * @function\n   * @api\n   */\n  exportResults() {\n    const features = this.layer_.getFeatures();\n    if (features.length > 0) {\n      const csvString = this.dataToCsv(features);\n      this.downloadCsv(csvString);\n    } else {\n      M.dialog.error(getValue('no_export_data'));\n    }\n  }\n\n  /**\n   * Saves features attributes on csv string.\n   * @public\n   * @function\n   * @param {M.feature} features - query results features\n   * @api\n   */\n  dataToCsv(features) {\n    let csv = '';\n    const featureKeys = Object.keys(features[0].getAttributes());\n    featureKeys.forEach((key) => { csv += `${key},`; });\n    csv = `${csv.substring(0, csv.length - 1)}\\n`; // deletes last ',' and adds line break\n\n    features.forEach((feature) => {\n      const featureAttrs = feature.getAttributes(); // {cod: '11', nombre: 'Cádiz'}\n      featureKeys.forEach((key) => {\n        // only escape() if string has more than letters and spaces\n        // substitute 'escape' (deprecated) for own escape method\n        // csv += `${escape(featureAttrs[key])},`;\n        csv += featureAttrs[key];\n        csv += ',';\n      });\n      csv = `${csv.substring(0, csv.length - 1)}\\n`; // deletes last ',' and adds line break\n    });\n    csv = csv.substring(0, csv.length - 1); // deletes last line break\n    return csv;\n  }\n\n  /**\n   * Creates hidden link element and clicks it to download given csv data.\n   * @public\n   * @function\n   * @api\n   * @param {String} csvdata - csv data with query results\n   */\n  downloadCsv(csvdata) {\n    const fileName = 'queryresults.csv';\n    const fileUrl = `data:text/csv;charset=utf-8,${encodeURI(csvdata)}`;\n    const hiddenLink = document.createElement('a');\n    hiddenLink.href = fileUrl;\n    hiddenLink.download = fileName;\n    hiddenLink.click();\n  }\n\n  /**\n   * Shows initial view buttons.\n   * @public\n   * @function\n   * @param {HTML Element} panelContainer - Buttons div container\n   * @api\n   */\n  setInitialButtons(panelContainer) {\n    const btnContainer = panelContainer;\n    btnContainer.querySelector('#volver-btn').style.display = 'none';\n    btnContainer.querySelector('#aceptar-btn').style.display = 'inline';\n    btnContainer.querySelector('#limpiar-busqueda-btn').style.display = 'inline';\n    btnContainer.querySelector('#limpiar-filtro-btn').style.display = 'inline';\n    btnContainer.querySelector('#vertabla-btn').style.display = 'none';\n    btnContainer.querySelector('#exportar-btn').style.display = 'none';\n    btnContainer.querySelector('#guardar-btn').style.display = 'none';\n    btnContainer.querySelector('#misconsultas-btn').style.display = 'inline';\n    btnContainer.querySelector('#eliminar-btn').style.display = 'none';\n  }\n\n  /**\n   * Shows buttons for view after a filter is set.\n   * @public\n   * @function\n   * @api\n   */\n  setOkButtons() {\n    document.querySelector('#volver-btn').style.display = 'none';\n    document.querySelector('#aceptar-btn').style.display = 'inline';\n    document.querySelector('#limpiar-busqueda-btn').style.display = 'inline';\n    document.querySelector('#limpiar-filtro-btn').style.display = 'inline';\n    document.querySelector('#vertabla-btn').style.display = 'inline';\n    document.querySelector('#exportar-btn').style.display = 'inline';\n    document.querySelector('#guardar-btn').style.display = 'inline';\n    document.querySelector('#misconsultas-btn').style.display = 'inline';\n    document.querySelector('#eliminar-btn').style.display = 'none';\n  }\n\n  /**\n   * Hides some buttons for \"Results table\" view.\n   * @public\n   * @function\n   * @param {HTML Element} container - Buttons div container\n   * @api\n   */\n  setTableViewButtons(container) {\n    const btnContainer = container;\n    btnContainer.querySelector('#volver-btn').style.display = 'inline';\n    btnContainer.querySelector('#aceptar-btn').style.display = 'none';\n    btnContainer.querySelector('#limpiar-busqueda-btn').style.display = 'none';\n    btnContainer.querySelector('#limpiar-filtro-btn').style.display = 'none';\n    btnContainer.querySelector('#vertabla-btn').style.display = 'none';\n    btnContainer.querySelector('#exportar-btn').style.display = 'none';\n    btnContainer.querySelector('#guardar-btn').style.display = 'none';\n    btnContainer.querySelector('#misconsultas-btn').style.display = 'none';\n  }\n\n  /**\n   * Hides all unnecessary buttons for MyQueries view.\n   * @public\n   * @function\n   * @api\n   * @param {HTML Element} container - Buttons div container\n   */\n  showMyQueriesViewButtons(container) {\n    const btnContainer = container;\n    btnContainer.querySelector('#volver-btn').style.display = 'inline';\n    btnContainer.querySelector('#aceptar-btn').style.display = 'none';\n    btnContainer.querySelector('#limpiar-busqueda-btn').style.display = 'none';\n    btnContainer.querySelector('#limpiar-filtro-btn').style.display = 'none';\n    btnContainer.querySelector('#vertabla-btn').style.display = 'none';\n    btnContainer.querySelector('#exportar-btn').style.display = 'none';\n    btnContainer.querySelector('#guardar-btn').style.display = 'none';\n    btnContainer.querySelector('#misconsultas-btn').style.display = 'none';\n  }\n\n  /**\n   * Cleans input selections.\n   * @public\n   * @function\n   * @api\n   */\n  cleanSearch() {\n    document.querySelector('.filtered-search-panel').querySelector('textarea').value = '';\n    document.querySelector('#m-filteredsearch-method-select').value = getValue('select_method');\n    this.selectionMethod = '';\n    this.sqlQuery = '';\n    document.querySelector('#m-filteredsearch-layers-select').querySelector('#layers0').selected = true;\n    document.querySelector('#m-filteredsearch-fields').innerHTML = `<p class=\"m-filteredsearch-headers\">${getValue('fields')}</p>`;\n    document.querySelector('#m-filteredsearch-values').innerHTML = `<p class=\"m-filteredsearch-headers\">${getValue('values')}</p>`;\n  }\n\n  /**\n   * Shows expected results page\n   * @public\n   * @function\n   * @param {Array <Array>} pages - results divided in pages\n   * @api\n   */\n  showTableViewPage(pages) {\n    // empty results table\n    this.filterResults.querySelector('#queryresults').innerHTML = '';\n\n    // Get layer attributes and show column titles and pagination buttons\n    const attributes = this.layer_.getFeatures()[0].getAttributes();\n    let newLine = document.createElement('tr');\n    Object.keys(attributes).forEach((attributeKey) => {\n      const newTitleCell = document.createElement('th');\n      const cellText = document.createTextNode(attributeKey);\n      newTitleCell.appendChild(cellText);\n      newLine.appendChild(newTitleCell);\n    });\n    this.filterResults.querySelector('#queryresults').appendChild(newLine);\n    this.filterResults.querySelector('#paginationbuttons>#pageNumBtn').innerHTML = `${this.resultsPage + 1} de ${pages.length}`;\n\n    // Show every result on a new table row\n    const currentPageFeatures = pages[this.resultsPage];\n    currentPageFeatures.forEach((filteredFeature) => {\n      newLine = document.createElement('tr');\n      const filteredAttributes = filteredFeature.getAttributes();\n      Object.keys(filteredAttributes).forEach((key) => {\n        const newCell = document.createElement('td');\n        // Commented code in case table field needs to show table\n        // const htmlContent = document.createElement('div');\n        // htmlContent.innerHTML = filteredAttributes[key];\n        // newCell.appendChild(htmlContent);\n        const txt = document.createTextNode(filteredAttributes[key].toString());\n        newCell.appendChild(txt);\n        newLine.appendChild(newCell);\n      });\n      this.filterResults.querySelector('#queryresults').appendChild(newLine);\n    });\n  }\n\n  /**\n   * Creates a table row for every result after filtering layer features.\n   * @function\n   * @public\n   * @api\n   */\n  saveResultsOnTable() {\n    if (this.layer_.getFeatures().length > 0) {\n      // Divide filter results into pages & show current page\n      const pages = this.divideList(this.layer_.getFeatures());\n      this.showTableViewPage(pages);\n\n      // Page turning\n      this.filterResults.querySelectorAll('#paginationbuttons>button').forEach((btn) => {\n        btn.addEventListener('click', (e) => {\n          if (e.target.id === 'prevBtn') {\n            this.resultsPage = this.resultsPage > 0 ? this.resultsPage -= 1 : this.resultsPage;\n          } else {\n            this.resultsPage = this.resultsPage < pages.length - 1 ?\n              this.resultsPage += 1 : this.resultsPage;\n          }\n          this.showTableViewPage(pages);\n        });\n      });\n    } else {\n      this.filterResults.innerHTML = getValue('no_entities');\n    }\n  }\n\n  /**\n   * Saves clicked button operator in query and adds it to textarea.\n   * @public\n   * @function\n   * @param {Event} e\n   * @param {HTML Element} btn\n   * @api\n   */\n  operatorClick(e, btn) {\n    const txtarea = document.querySelector('.filtered-search-panel').querySelector('textarea');\n    switch (btn.innerHTML) {\n      case '()':\n        if (this.parenthesesClick === 0) {\n          txtarea.value += '(';\n          this.sqlQuery += '(';\n          this.parenthesesClick = 1;\n        } else {\n          txtarea.value += ')';\n          this.sqlQuery += ')';\n          this.parenthesesClick = 0;\n        }\n        break;\n      case '&#61;':\n        txtarea.value += ' = ';\n        this.sqlQuery += ' = ';\n        break;\n      case '&lt;':\n        txtarea.value += ' < ';\n        this.sqlQuery += ' < ';\n        break;\n      case '&gt;':\n        txtarea.value += ' > ';\n        this.sqlQuery += ' > ';\n        break;\n      case '&lt;&gt;':\n        txtarea.value += ' <> ';\n        this.sqlQuery += ' <> ';\n        break;\n      case '&gt;=':\n        txtarea.value += ' >= ';\n        this.sqlQuery += ' >= ';\n        break;\n      case '&lt;=':\n        txtarea.value += ' <= ';\n        this.sqlQuery += ' <= ';\n        break;\n      case '_': // sql _ -> regexp .\n        txtarea.value += '_';\n        this.sqlQuery += '.';\n        break;\n      case '%': // sql % -> regexp .*\n        txtarea.value += '%';\n        this.sqlQuery += '.*';\n        break;\n      default:\n        txtarea.value += ` ${btn.innerHTML.toLowerCase()} `;\n        this.sqlQuery += ` ${btn.innerHTML.toLowerCase()} `;\n    }\n  }\n\n  /**\n   * Shows selected layer fields list first page (if layer is loaded).\n   * @public\n   * @function\n   * @param { String } layerName - selected layer name\n   * @api\n   */\n  showLayerFields(layerName) {\n    // finds and saves param layerName\n    if (!M.utils.isNullOrEmpty(layerName)) {\n      this.layer_ = this.hasLayer_(layerName)[0];\n    }\n\n    if (this.isLayerLoaded(this.layer_)) {\n      this.fieldValues = [];\n      const features = this.layer_.getFeatures();\n\n      // clears previous query\n      this.oldFilter = this.mapeaFilterQuery;\n      this.oldLayer = this.layer_;\n      document.querySelector('.filtered-search-panel').querySelector('textarea').value = '';\n      this.sqlQuery = '';\n      this.mapeaFilterQuery = null;\n\n      // if there's features on this.layer_, save them and their values on arrays\n      if (!M.utils.isNullOrEmpty(features)) {\n        this.fields = Object.keys(features[0].getAttributes());\n        features.forEach((feature) => {\n          const properties = Object.values(feature.getAttributes());\n          if (!M.utils.isNullOrEmpty(properties)) {\n            this.fieldValues.push(properties);\n          }\n        });\n\n        this.fieldsPages = this.divideList(this.fields);\n        const fields = this.fieldsPages[0];\n\n        const options = { jsonp: true, vars: { fields } };\n        this.fieldsTemplate = M.template.compileSync(fieldsTemplate, options);\n        this.fieldsTemplate.querySelector('#pageNumBtn').innerHTML = `1 de ${this.fieldsPages.length}`;\n        document.querySelector('#m-filteredsearch-fields').innerHTML = `<p class=\"m-filteredsearch-headers\">${getValue('fields')}</p>`;\n        document.querySelector('#m-filteredsearch-fields').appendChild(this.fieldsTemplate);\n\n        this.showFields();\n        this.addpageBtnEvt();\n      }\n    } else {\n      M.dialog.error(getValue('layer_load'));\n    }\n  }\n\n  /**\n   * Checks if layer is loaded.\n   * @public\n   * @function\n   * @param {Mapea Layer} layer - clicked layer on select menu\n   * @api\n   */\n  isLayerLoaded(layer) {\n    let isLoaded = false;\n    const kmlLayerLoaded = this.kmlLayers.find(l => l.layer === layer) ?\n      this.kmlLayers.find(l => l.layer === layer).loaded : false;\n    if (layer.type && layer.type !== 'KML' && layer.getImpl().isLoaded()) {\n      isLoaded = true;\n    } else if (kmlLayerLoaded) {\n      isLoaded = true;\n    }\n    return isLoaded;\n  }\n\n  /**\n   * Adds click event on each field.\n   * Adds field name to query, finds possible field values and shows them and changes cell focus.\n   * @public\n   * @function\n   * @api\n   */\n  showFields() {\n    document.querySelector('#m-filteredsearch-fields').querySelectorAll('td').forEach((cell) => {\n      const values = [];\n      const fieldIndex = this.fields.indexOf(cell.innerHTML);\n      this.fieldValues.forEach((element) => {\n        values.push(element[fieldIndex]);\n      });\n      cell.addEventListener('click', (e) => {\n        const txtarea = document.querySelector('.filtered-search-panel').querySelector('textarea');\n        txtarea.value += e.target.innerHTML;\n        this.sqlQuery += e.target.innerHTML;\n        this.selectField(values);\n        // sets 'focus'\n        Array.prototype.forEach.call(\n          e.target.parentNode.parentNode.parentNode.children[0].children,\n          (row) => {\n            Array.prototype.forEach.call(row.children, (rowCell) => {\n              rowCell.classList.remove('focus');\n            });\n          },\n        );\n        e.target.classList.add('focus');\n      });\n    });\n  }\n\n  /**\n   * Adds pagination buttons onclick events.\n   * @public\n   * @function\n   * @api\n   */\n  addpageBtnEvt() {\n    this.fieldsTemplate.querySelectorAll('#m-attributetable-tfoot>button').forEach((element) => {\n      element.addEventListener('click', e => this.changePage(e, 'fields', this.fieldsPages.length));\n    });\n    this.valuesTemplate.querySelectorAll('#m-attributetable-tfoot>button').forEach((element) => {\n      element.addEventListener('click', e => this.changePage(e, 'values', this.valuesPages.length));\n    });\n  }\n\n  /**\n   * Divides list items in groups of 5 items.\n   * @public\n   * @function\n   * @api\n   * @param {List} items - items (fields/values) to separate in pages\n   * @returns {Array <Array>} pages - each inside array has n items\n   */\n  divideList(items) {\n    const numberOfItemsPerPage = 5;\n    const pages = [];\n    let firstItem = 0;\n    while (firstItem < items.length) {\n      const newPage = [];\n      for (let i = firstItem; i < firstItem + numberOfItemsPerPage; i += 1) {\n        newPage.push(items[i]);\n        if (i + 1 === items.length) {\n          i = firstItem + numberOfItemsPerPage;\n        }\n      }\n      pages.push(newPage);\n      firstItem += numberOfItemsPerPage;\n    }\n    return pages;\n  }\n\n  /**\n   * Changes currentPage number and shows page results on fields/values list.\n   * @public\n   * @function\n   * @api\n   * @param {Event} e - event triggering button\n   * @param {String} fieldsOrValues - container key (either 'fields' or 'values')\n   * @param {Number} numberOfPages\n   */\n  changePage(e, fieldsOrValues, numberOfPages) {\n    let currentPage = fieldsOrValues === 'fields' ? this.currentFieldsPage : this.currentValuesPage;\n\n    if (e.target.id === 'prevBtn') {\n      currentPage = currentPage > 0 ? currentPage -= 1 : currentPage;\n    } else {\n      currentPage = currentPage < numberOfPages - 1 ? currentPage += 1 : currentPage;\n    }\n\n    if (fieldsOrValues === 'fields') {\n      this.currentFieldsPage = currentPage;\n    } else {\n      this.currentValuesPage = currentPage;\n    }\n\n    this.showPageResults(fieldsOrValues);\n    this.addpageBtnEvt();\n  }\n\n  /**\n   * Shows current page results on fields/values area.\n   * @public\n   * @function\n   * @api\n   * @param {HTML Element} fieldsOrValues - element where items will be shown\n   */\n  showPageResults(fieldsOrValues) {\n    if (fieldsOrValues === 'fields') {\n      const fields = this.fieldsPages[this.currentFieldsPage];\n      const options = { jsonp: true, vars: { fields } };\n      this.fieldsTemplate = M.template.compileSync(fieldsTemplate, options);\n      this.fieldsTemplate.querySelector('#pageNumBtn').innerHTML = `${this.currentFieldsPage + 1} de ${this.fieldsPages.length}`;\n      document.querySelector('#m-filteredsearch-fields').innerHTML = `<p class=\"m-filteredsearch-headers\">${getValue('fields')}</p>`;\n      document.querySelector('#m-filteredsearch-fields').appendChild(this.fieldsTemplate);\n      this.showFields();\n    } else {\n      const values = this.valuesPages[this.currentValuesPage];\n      const options = { jsonp: true, vars: { values } };\n      this.valuesTemplate = M.template.compileSync(valuesTemplate, options);\n      this.valuesTemplate.querySelector('#pageNumBtn').innerHTML = `${this.currentValuesPage + 1} de ${this.valuesPages.length}`;\n      this.fieldsTemplate.querySelector('#pageNumBtn').innerHTML = `${this.currentFieldsPage + 1} de ${this.fieldsPages.length}`;\n      document.querySelector('#m-filteredsearch-values').innerHTML = `<p class=\"m-filteredsearch-headers\">${getValue('values')}</p>`;\n      document.querySelector('#m-filteredsearch-values').appendChild(this.valuesTemplate);\n      document.querySelector('#m-filteredsearch-values').querySelectorAll('td').forEach((cell) => {\n        cell.addEventListener('click', (e) => {\n          const txtarea = document.querySelector('.filtered-search-panel').querySelector('textarea');\n          txtarea.value += e.target.innerHTML;\n          this.sqlQuery += e.target.innerHTML;\n          Array.prototype.forEach.call(\n            e.target.parentNode.parentNode.parentNode.children[0].children,\n            (row) => {\n              Array.prototype.forEach.call(row.children, (rowCell) => {\n                rowCell.classList.remove('focus');\n              });\n            },\n          );\n          e.target.classList.add('focus');\n        });\n      });\n    }\n  }\n\n  /**\n   * Shows possible values for selected field.\n   * @public\n   * @function\n   * @param {Array} values - existing values for selected field\n   * @api\n   */\n  selectField(fieldValues) {\n    // reduces field values to unique possible values\n    const values = fieldValues.filter((value, index, self) => {\n      return self.indexOf(value) === index;\n    });\n\n    this.valuesPages = this.divideList(values);\n    const firstValues = this.valuesPages[0];\n    const options = { jsonp: true, vars: { values: firstValues } };\n\n    this.currentFieldsPage = 0;\n    this.currentValuesPage = 0;\n\n    this.valuesTemplate = M.template.compileSync(valuesTemplate, options);\n    this.valuesTemplate.querySelector('#pageNumBtn').innerHTML = `${this.currentValuesPage + 1} de ${this.valuesPages.length}`;\n\n    this.valuesTemplate.querySelectorAll('#m-filteredsearch-valuestable>tbody>tr>td').forEach((tableCell) => {\n      tableCell.addEventListener('click', e => this.selectValue(e));\n    });\n    document.querySelector('#m-filteredsearch-values').innerHTML = `<p class='m-filteredsearch-headers'>${getValue('values')}</p>`;\n    document.querySelector('#m-filteredsearch-values').appendChild(this.valuesTemplate);\n    this.addpageBtnEvt();\n  }\n\n  /**\n   * Adds clicked option info to textarea and query.\n   * @public\n   * @function\n   * @param {Event} e - triggering event\n   * @api\n   */\n  selectValue(e) {\n    const txtarea = document.querySelector('.filtered-search-panel').querySelector('textarea');\n    txtarea.value += e.currentTarget.innerHTML;\n    this.sqlQuery += e.currentTarget.innerHTML;\n    Array.prototype.forEach.call(\n      e.currentTarget.parentNode.parentNode.children,\n      (row) => {\n        row.children[0].classList.remove('focus');\n      },\n    );\n    e.currentTarget.classList.add('focus');\n  }\n\n  /**\n   * Checks if map has given layer and returns that layer.\n   *\n   * @private\n   * @param {array<string>| string| M.Layer} layerSearch -\n        Array of layer names, layer name or layer instance\n   * @function\n   */\n  hasLayer_(layerSearch) {\n    const layersFind = [];\n    if (M.utils.isNullOrEmpty(layerSearch) || (!M.utils.isArray(layerSearch) &&\n      !M.utils.isString(layerSearch) && !(layerSearch instanceof M.Layer))) {\n      M.dialog.error(getValue('hasLayer_error'), getValue('error'));\n      return layersFind;\n    }\n\n    if (M.utils.isString(layerSearch)) {\n      this.map.getLayers().forEach((lay) => {\n        if (lay.name === layerSearch) {\n          layersFind.push(lay);\n        }\n      });\n    }\n\n    if (layerSearch instanceof M.Layer) {\n      this.map.getLayers().forEach((lay) => {\n        if (lay.equals(layerSearch)) {\n          layersFind.push(lay);\n        }\n      });\n    }\n    if (M.utils.isArray(layerSearch)) {\n      this.map.getLayers().forEach((lay) => {\n        if (layerSearch.indexOf(lay.name) >= 0) {\n          layersFind.push(lay);\n        }\n      });\n    }\n    return layersFind;\n  }\n\n  /**\n   * This function compares controls\n   *\n   * @public\n   * @function\n   * @param {M.Control} control to compare\n   * @api stable\n   */\n  equals(control) {\n    return control instanceof FilteredSearchControl;\n  }\n}\n","/**\n * @module M/plugin/FilteredSearch\n */\nimport 'assets/css/filteredsearch';\nimport 'assets/css/fonts';\nimport FilteredSearchControl from './filteredsearchcontrol';\nimport api from '../../api';\nimport { getValue } from './i18n/language';\n\nexport default class FilteredSearch extends M.Plugin {\n  /**\n   * @classdesc\n   * Main facade plugin object. This class creates a plugin\n   * object which has an implementation Object\n   *\n   * @constructor\n   * @extends {M.Plugin}\n   * @param {Object} impl implementation object\n   * @api stable\n   */\n  constructor(options = {}) {\n    super();\n    /**\n     * Facade of the map\n     * @private\n     * @type {M.Map}\n     */\n    this.map_ = null;\n\n    /**\n     * Array of controls\n     * @private\n     * @type {Array<M.Control>}\n     */\n    this.controls_ = [];\n\n    /**\n     * Position of the plugin on browser window\n     * @private\n     * @type {Enum}\n     * Possible values: 'TL', 'TR', 'BR', 'BL'\n     */\n    this.position_ = options.position || 'TR';\n\n    /**\n     * Metadata from api.json\n     * @private\n     * @type {Object}\n     */\n    this.metadata_ = api.metadata;\n  }\n\n  /**\n   * This function adds this plugin into the map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map the map to add the plugin\n   * @api stable\n   */\n  addTo(map) {\n    const pluginOnLeft = !!(['TL', 'BL'].includes(this.position_));\n\n    const values = {\n      pluginOnLeft,\n    };\n\n    this.control_ = new FilteredSearchControl(values);\n    this.controls_.push(this.control_);\n    this.map_ = map;\n\n    // Dependiendo de dónde se muestre el plugin, mostrará una flecha u otra.\n    const collapsedButton = 'g-plugin-filteredsearch-filter';\n\n    // panel para agregar control - no obligatorio\n    this.panel_ = new M.ui.Panel('panelFilteredSearch', {\n      className: 'filtered-search-panel',\n      collapsible: true,\n      position: M.ui.position[this.position_],\n      collapsedButtonClass: collapsedButton,\n      tooltip: getValue('tooltip'),\n    });\n    this.panel_.addControls(this.controls_);\n    map.addPanels(this.panel_);\n  }\n\n  /**\n   * Destroys plugin\n   * @public\n   * @function\n   * @api\n   */\n  destroy() {\n    this.map_.removeControls(this.controls_);\n    [this.map_, this.control_, this.controls_, this.panel_] = [null, null, null, null];\n  }\n\n  /**\n   * This function gets metadata plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getMetadata() {\n    return this.metadata_;\n  }\n\n  /**\n   * @getter\n   * @public\n   */\n  get name() {\n    return 'filteredsearch';\n  }\n}\n","import M$plugin$FilteredSearch from './/facade/js/filteredsearch';\nimport M$control$FilteredSearchControl from './/facade/js/filteredsearchcontrol';\nimport M$impl$control$FilteredSearchControl from './/impl/ol/js/filteredsearchcontrol';\n\nif (!window.M.plugin) window.M.plugin = {};\nif (!window.M.control) window.M.control = {};\nif (!window.M.impl) window.M.impl = {};\nif (!window.M.impl.control) window.M.impl.control = {};\nwindow.M.plugin.FilteredSearch = M$plugin$FilteredSearch;\nwindow.M.control.FilteredSearchControl = M$control$FilteredSearchControl;\nwindow.M.impl.control.FilteredSearchControl = M$impl$control$FilteredSearchControl;\n"],"sourceRoot":""}